---
// src/pages/tarifs.astro
import BaseLayout from "../layouts/BaseLayout.astro";
import PageTitle from "../components/PageTitle.astro";
import InternalLinksBlock from "../components/InternalLinksBlock.astro";

import { buildSeo, buildBreadcrumbs } from "../lib/seo";
import { buildInternalLinks } from "../lib/linking";

import services from "../data/services.json";

const seo = buildSeo({
  pageType: "pricing",
  origin: Astro.url.origin,
  pathname: Astro.url.pathname
});

const bc = buildBreadcrumbs({
  pageType: "pricing",
  origin: Astro.url.origin
});

const internalLinks = buildInternalLinks({
  pageType: "pricing"
});

const schema = Array.isArray(seo.schema) ? [...seo.schema, bc.schema] : [seo.schema, bc.schema];

// Packs (structure JSON-like, pilotable facilement)
const packs = [
  {
    slug: "audit",
    badge: "Recommandé pour démarrer",
    title: "Audit + plan d’action",
    price: "À partir de 390€",
    cadence: "one-shot",
    desc: "Une analyse claire + une liste d’actions priorisées (SEO/Ads/CRO) pour générer plus de demandes.",
    included: [
      "Audit visibilité locale (site + fiche Google + concurrence)",
      "Audit conversion (messages, preuves, CTA, friction)",
      "Plan d’action priorisé (quick wins + chantier 30/60/90 jours)",
      "Recommandations tracking simple (appels, formulaires, clics contact)",
      "Call de restitution + questions/réponses"
    ],
    cta: { href: "/contact", label: "Demander l’audit gratuit" },
    note: "L’audit est gratuit sur demande : on valide d’abord l’adéquation et vos objectifs."
  },
  {
    slug: "local",
    badge: "Récurrence",
    title: "SEO local (pilotage)",
    price: "À partir de 590€/mois",
    cadence: "mensuel",
    desc: "Être visible sur Google/Maps dans le Sud Oise (60) et le Nord 95, et convertir cette visibilité en appels/devis.",
    included: [
      "Optimisation / structuration fiche Google (GBP)",
      "Pages locales service+ville (priorisées)",
      "Optimisation contenus + preuves (avis, process, réassurance)",
      "Suivi conversions (appels, formulaires) et points mensuels",
      "Itérations selon KPI (ce qui marche / ce qu’on teste)"
    ],
    cta: { href: "/contact", label: "Recevoir un plan d’action" },
    note: "Le rythme dépend du point de départ et de la concurrence locale. Pas de promesse de position : pilotage + mesure."
  },
  {
    slug: "ads",
    badge: "Accélération",
    title: "Google Ads / Meta (pilotage)",
    price: "À partir de 490€/mois",
    cadence: "mensuel",
    desc: "Générer des demandes plus vite avec des campagnes structurées (sans gaspillage) + pages qui convertissent.",
    included: [
      "Création ou refonte structure campagnes (services/zones/intention)",
      "Messages orientés conversion (preuves, différenciation)",
      "Optimisations continues (requêtes, ciblages, budgets, annonces/créas)",
      "Tracking conversions (appels, formulaires, événements clés)",
      "Reporting simple : décisions et actions du mois"
    ],
    cta: { href: "/contact", label: "Parler du budget pub" },
    note: "Le budget publicitaire est séparé : on démarre souvent par un budget test mesurable, puis on ajuste."
  }
];

// Liste “ce que vous achetez” par service (data-driven)
const serviceCards = (services as any[]).map((s: any) => ({
  slug: s.slug,
  name: s.name,
  short: s.short,
  deliverables: (s.deliverables ?? []).slice(0, 6),
  href: `/${s.slug}`
}));
---

<BaseLayout
  title={seo.title}
  description={seo.description}
  canonical={seo.canonical}
  ogImage={seo.ogImage}
  schema={schema}
>

  <PageTitle
    kicker="Offres & transparence"
    titleHtml={"Tarifs webmarketing <br>(entreprises de nettoyage)"}
    description="SEO local (Google & Maps), Google Ads/Meta Ads et optimisation conversion (CRO) avec tracking simple. L’objectif : plus de demandes (appels, devis) — via une méthode pilotée, sans promesses “garanties”."
    bgImage="/_assets_/images/page-title.jpg"
    breadcrumbs={bc.items}
    ctas={[
      { href: "/contact", label: "Demander un audit gratuit", variant: "primary" },
      { href: "/methode", label: "Voir la méthode", variant: "secondary" }
    ]}
  />

  <!-- Content
  ============================================= -->
  <section id="content">
    <div class="content-wrap pt-4 pb-0">

      <!-- Packs -->
      <div class="container">
        <div class="row pricing col-mb-30 mb-4 justify-content-center">

          {packs.map((p) => (
            <div class="col-lg-4 col-md-6">
              <div class="pricing-box rounded-3 h-shadow shadow-ts p-3">
                <div class="card-body d-flex flex-column">
                  <div class="d-flex justify-content-between align-items-start">
                    <div>
                      <div class="text-uppercase ls-2 text-muted small">{p.badge}</div>
                      <h3 class="mt-2 mb-2 text-transform-none fw-semibold ls-0">{p.title}</h3>
                    </div>
                    <span class="badge bg-color">{p.cadence}</span>
                  </div>

                  <div class="my-3">
                    <div class="h2 color fw-bold mb-0">{p.price}</div>
                    <small class="text-muted">selon zone, concurrence, volume d’actions</small>
                  </div>

                  <p class="text-black-50">{p.desc}</p>

                  <div class="line my-3"></div>

                  <ul class="iconlist mb-4 text-black-50">
                    {p.included.map((it) => <li><i class="bi-check-circle-fill color me-2"></i>{it}</li>)}
                  </ul>

                  <div class="mt-auto">
                    <a href={p.cta.href} class="btn btn-lg bg-color text-white fw-semibold px-4 w-100">{p.cta.label}</a>
                    <small class="d-block mt-2 text-black-50">{p.note}</small>
                  </div>
                </div>
              </div>
            </div>
          ))}

        </div>
      </div>

      <div class="clear"></div>

      <!-- What you get (service breakdown) -->
      <div class="section mb-0 mt-6" style="padding-bottom: 100px; overflow: visible">
        <div class="svg-separator top">
          <div>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2273 390" fill="#F9F9F9"><path d="M0,211.28s373-254,1119-205,765,173,1154,0v384H0Z"></svg>
          </div>
        </div>
        <div class="container">
          <div class="heading-block text-center mx-auto" style="max-width: 820px">
            <h2 class="mb-2 text-transform-none ls-0">Ce qui est inclus (concret)</h2>
            <span>
              Le but : transformer votre visibilité en demandes. Chaque service a ses livrables et ses KPI.
              Pour le détail complet : pages service.
            </span>
          </div>

          <div class="row col-mb-30">
            {serviceCards.map((s) => (
              <div class="col-lg-4 col-md-6">
                <div class="card text-center border-0 shadow-sm">
                  <div class="card-body p-4">
                    <h3 class="text-transform-none fw-semibold ls-0 mb-2">{s.name}</h3>
                    <p class="text-black-50 mb-3">{s.short}</p>

                    <ul class="iconlist text-black-50 mb-4">
                      {s.deliverables.map((d: string) => (
                        <li><i class="bi-dot color me-2"></i>{d}</li>
                      ))}
                    </ul>

                    <div class="d-flex gap-2 flex-wrap">
                      <a href={s.href} class="button button-rounded button-light button-large second-bg-color text-dark w-100 ls-0 m-0">Voir le service</a>
                      <a href="/contact" class="button button-rounded button-light button-large second-bg-color text-dark w-100 ls-0 m-0">Audit gratuit</a>
                    </div>
                  </div>
                </div>
              </div>
            ))}
          </div>

          <div class="mt-4 text-center">
            <a href="/preuves" class="fw-semibold">Voir des preuves & exemples <i class="bi-arrow-right color"></i></a>
            <a href="/zones" class="fw-semibold">Zones couvertes (60/95) <i class="bi-arrow-right color"></i></a>
          </div>
        </div>
      </div>

      <!-- Pricing FAQs (toggles style template) -->
      <div class="container mb-6">
        <div class="fancy-title title-border mt-5">
          <h3 class="fw-semibold">FAQ tarifs</h3>
        </div>

        <div class="toggle">
          <div class="toggle-header justify-content-between">
            <div class="toggle-icon">
              <i class="toggle-closed bi-plus-circle"></i>
              <i class="toggle-open bi-dash-circle"></i>
            </div>
            <div class="toggle-title fw-semibold">
              Pourquoi “à partir de” plutôt qu’un prix unique ?
            </div>
          </div>
          <div class="toggle-content text-black-50">
            Parce que l’effort dépend du point de départ (fiche Google, site, concurrence locale, nombre de villes/pages),
            et de votre objectif (récurrence, urgence, types de clients). On préfère un cadrage clair après audit plutôt qu’un prix trompeur.
          </div>
        </div>

        <div class="toggle">
          <div class="toggle-header justify-content-between">
            <div class="toggle-icon">
              <i class="toggle-closed bi-plus-circle"></i>
              <i class="toggle-open bi-dash-circle"></i>
            </div>
            <div class="toggle-title fw-semibold">
              Est-ce que vous garantissez un nombre de leads ?
            </div>
          </div>
          <div class="toggle-content text-black-50">
            Non. On met en place un système piloté (tracking + optimisations) pour améliorer la quantité et la qualité des demandes,
            sans promesse irréaliste. On mesure et on itère.
          </div>
        </div>

        <div class="toggle">
          <div class="toggle-header justify-content-between">
            <div class="toggle-icon">
              <i class="toggle-closed bi-plus-circle"></i>
              <i class="toggle-open bi-dash-circle"></i>
            </div>
            <div class="toggle-title fw-semibold">
              Le budget publicitaire est-il inclus ?
            </div>
          </div>
          <div class="toggle-content text-black-50">
            Non. Les honoraires couvrent la stratégie, la mise en place, le tracking et le pilotage.
            Le budget pub (Google/Meta) est séparé : on démarre souvent par un budget test mesurable, puis on ajuste.
          </div>
        </div>

        <div class="toggle">
          <div class="toggle-header justify-content-between">
            <div class="toggle-icon">
              <i class="toggle-closed bi-plus-circle"></i>
              <i class="toggle-open bi-dash-circle"></i>
            </div>
            <div class="toggle-title fw-semibold">
              Combien de temps avant de voir des effets ?
            </div>
          </div>
          <div class="toggle-content text-black-50">
            Le SEO local progresse dans le temps (avec des quick wins possibles sur la fiche et les pages).
            Les Ads peuvent produire des demandes plus vite… à condition d’avoir une landing/page qui convertit et un tracking fiable.
          </div>
        </div>

        <div class="toggle">
          <div class="toggle-header justify-content-between">
            <div class="toggle-icon">
              <i class="toggle-closed bi-plus-circle"></i>
              <i class="toggle-open bi-dash-circle"></i>
            </div>
            <div class="toggle-title fw-semibold">
              Vous travaillez uniquement sur le Sud Oise (60) et le Nord 95 ?
            </div>
          </div>
          <div class="toggle-content text-black-50">
            Oui, c’est le cœur de notre dispositif local-first : pages locales structurées (zone → ville → service) et messages adaptés au terrain.
          </div>
        </div>
      </div>

      <!-- Internal links block (maillage auto) -->
      <div class="container">
        <InternalLinksBlock data={internalLinks} />
      </div>

      <!-- Final CTA -->
      <div class="section text-center mb-0" style="padding: 120px 0; background-color: rgba(51,94,238,0.08);">
        <div class="container" style="max-width: 760px">
          <img src="/_assets_/images/icons/apply.svg" alt="Audit Icon" height="200" class="mb-4">
          <h2 style="font-size: 38px">On vous propose la bonne combinaison (SEO / Ads / CRO)</h2>
          <p class="mb-5" style="font-size: 1.125rem;">
            Indiquez votre ville/zone et votre objectif. Vous recevez un plan d’action priorisé et une recommandation adaptée
            (sans survente, et avec mesure).
          </p>
          <a href="/contact" class="btn btn-lg bg-color text-white fw-semibold px-4">Demander un audit gratuit</a>
          <a href="/preuves" class="btn btn-lg bg-white fw-semibold color px-4 ms-2">Voir des preuves</a>
        </div>
      </div>

    </div>
  </section><!-- #content end -->

</BaseLayout>