---
// src/components/PageTitle.astro

type BreadcrumbItem = {
  label: string;
  href: string;
  position?: number;
};

type Cta = {
  href: string;
  label: string;
  variant?: "primary" | "secondary";
};

type Props = {
  kicker?: string;                 // petit texte au-dessus du titre
  title?: string;                  // titre simple
  titleHtml?: string;              // titre avec <br> etc.
  description?: string;            // texte sous le titre
  bgImage?: string;                // image de fond parallax
  breadcrumbs?: BreadcrumbItem[];  // fil d'ariane
  ctas?: Cta[];                    // 1 à 2 CTA recommandés
};

const {
  kicker,
  title,
  titleHtml,
  description,
  bgImage = "/_assets_/images/page-title.jpg",
  breadcrumbs = [],
  ctas = []
} = Astro.props as Props;

const hasBreadcrumbs = breadcrumbs?.length > 0;
const ctaPrimary = ctas.find((c) => c.variant !== "secondary") ?? ctas[0];
const ctaSecondary = ctas.find((c) => c.variant === "secondary") ?? ctas[1];
---

<!-- Page Title
============================================= -->
<section class="page-title dark page-title-parallax scroll-detect parallax include-header py-6">
  <img
    src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1 1'%3E%3C/svg%3E"
    data-src={bgImage}
    class="parallax-bg lazy"
    alt=""
  >

  <div class="container">
    <div class="page-title-row pt-5 pb-3">

      <div class="page-title-content">
        {kicker ? <span class="color fw-medium my-0">{kicker}</span> : null}

        <h1>
          {titleHtml ? (
            <Fragment set:html={titleHtml} />
          ) : (
            <Fragment>{title}</Fragment>
          )}
        </h1>

        {description ? (
          <span class="fw-light" style="max-width: 40rem;">
            {description}
          </span>
        ) : null}

        {(ctaPrimary || ctaSecondary) ? (
          <div class="page-title-buttons mt-5">
            {ctaPrimary ? (
              <a href={ctaPrimary.href} class="btn btn-lg bg-color text-white fw-semibold px-4">
                {ctaPrimary.label}
              </a>
            ) : null}

            {ctaSecondary ? (
              <a
                href={ctaSecondary.href}
                class="btn btn-lg bg-white fw-semibold color px-4 ms-2"
              >
                {ctaSecondary.label}
                <i class="bi-arrow-up-right ms-1 me-0 small"></i>
              </a>
            ) : null}
          </div>
        ) : null}
      </div>

      {hasBreadcrumbs ? (
        <nav aria-label="breadcrumb" class="d-none d-lg-block">
          <ol class="breadcrumb" style="--bs-breadcrumb-divider: '&#62;';">
            {breadcrumbs.map((item, idx) => {
              const isFirst = idx === 0;
              const isLast = idx === breadcrumbs.length - 1;

              if (isFirst) {
                return (
                  <li class="breadcrumb-item">
                    <a href={item.href} aria-label="Accueil"><i class="uil uil-home"></i></a>
                  </li>
                );
              }

              return isLast ? (
                <li class="breadcrumb-item active" aria-current="page">{item.label}</li>
              ) : (
                <li class="breadcrumb-item"><a href={item.href}>{item.label}</a></li>
              );
            })}
          </ol>
        </nav>
      ) : null}

    </div>
  </div>
</section><!-- .page-title end -->