---
// src/pages/offres/index.astro
import BaseLayout from "../../layouts/BaseLayout.astro";
import Header from "../../components/Header.astro";
import Hero from "../../components/Hero.astro";
import Contact from "../../components/Contact.astro";
import Faqs from "../../components/Faqs.astro";
import Reassurance from "../../components/Reassurance.astro";
import Promo from "../../components/Promo.astro";
import Footer from "../../components/Footer.astro";

import ui from "../../data/ui.json";
import offres from "../../data/offres.json";

import { href, canonicalUrl } from "../../lib/href";

type Pack = (typeof offres)["packs"][number];

const SITE = (offres as any).meta.canonicalBase ?? "https://avocats.horizon-conversion.fr";

const canonical = canonicalUrl(SITE, "/offres");

const title = (offres as any).meta.titleIndex;
const description = (offres as any).meta.descIndex;

const hero = {
  ...ui.hero.defaultInner,
  eyebrow: (offres as any).index.hero.eyebrow,
  title: (offres as any).index.hero.title,
  subtitle: (offres as any).index.hero.subtitle,
  primaryCta: { label: "Demander un audit", href: href("/contact") },
  secondaryCta: { label: "Comprendre la méthode", href: href("/methode") },
  note: (offres as any).index.hero.note
};

const packs = (offres as any).packs as Pack[];

const faqs = [
  {
    q: "Comment choisir entre Essentiel, Croissance et Signature ?",
    a: "Essentiel pose les bases. Croissance convient si vous visez une progression régulière (pages locales + pilotage). Signature s’impose lorsqu’il faut refondre/structurer et piloter un dispositif plus complet."
  },
  {
    q: "La publicité est-elle incluse ?",
    a: "Non. Google Ads est une option, activée uniquement si les pages et la mesure sont prêtes, et avec un cadrage strict pour préserver la qualité des demandes."
  },
  {
    q: "Mesurez-vous les appels et formulaires ?",
    a: "Oui : formulaires envoyés et actions liées à l’appel (clic téléphone), plus les sources et pages d’entrée."
  },
  {
    q: "Proposez-vous un engagement de résultat ?",
    a: "Non. Nous nous engageons sur la méthode, les livrables et une mesure fiable."
  }
];
---

<BaseLayout title={title} description={description} canonical={canonical}>
  <Header />
  <Hero {...hero} />

  <section id="content">
    <div class="content-wrap overflow-visible py-0">

      <div class="section py-6 m-0" style="background-color:#f1f3f7">
        <div class="container">
          <div class="row align-items-end justify-content-between mb-4">
            <div class="col-lg-7">
              <div class="before-title text-uppercase ls-3 text-smaller op-06 mb-2">{(offres as any).index.badge}</div>
              <h2 class="h3 fw-bold mb-2">{(offres as any).index.sectionTitle}</h2>
              <p class="lead mb-0 op-07">{(offres as any).index.sectionIntro}</p>
            </div>
          </div>

          <div class="row g-4 align-items-stretch">
            {packs.map((p) => (
              <div class="col-md-6 col-lg-4">
                <div class={`hc-pack card rounded-6 h-100 ${p.featured ? "hc-pack--featured" : ""}`}>
                  <div class="card-body p-4 p-lg-5 d-flex flex-column">
                    <div class="d-flex justify-content-between align-items-start mb-3">
                      <div>
                        {p.featured && p.badge && <span class="badge text-bg-warning mb-2">{p.badge}</span>}
                        <div class="h5 fw-bold mb-1">{p.name}</div>
                        <div class="op-07">{p.tagline}</div>
                      </div>
                      <span class="material-symbols-outlined op-06" aria-hidden="true">{p.icon ?? "arrow_right_alt"}</span>
                    </div>

                    <div class="mb-3">
                      <div class="fw-bold">Setup</div>
                      <div class="op-07">{p.budget.setup}</div>
                      <div class="fw-bold mt-2">Mensuel</div>
                      <div class="op-07">{p.budget.monthly}</div>
                    </div>

                    <ul class="hc-list op-08 mb-4">
                      <li>{p.short}</li>
                    </ul>

                    <div class="mt-auto d-grid gap-2">
                      <a href={href(`/offres/${p.slug}`)} class="btn btn-outline-dark py-3 rounded-1">Voir le détail</a>
                      <a href={href("/contact")} class="btn btn-dark bg-color py-3 rounded-1">Demander un audit</a>
                    </div>
                  </div>
                </div>
              </div>
            ))}
          </div>

          <div class="row mt-4">
            <div class="col-lg-10">
              <div class="small op-07">
                <strong>Option Google Ads :</strong> {(offres as any).index.adsNote}
              </div>
            </div>
          </div>

          <style>
            .hc-pack { border: 1px solid rgba(0,0,0,.06); box-shadow: 0 10px 25px rgba(0,0,0,.05); }
            .hc-pack--featured { border-color: rgba(255,193,7,.55); box-shadow: 0 14px 34px rgba(0,0,0,.08); }
            .hc-list { list-style: none; padding-left: 0; margin: 0; display: grid; gap: .55rem; }
            .hc-list li { position: relative; padding-left: 1.4rem; }
            .hc-list li::before { content: "•"; position: absolute; left: .4rem; color: var(--bs-warning); }
          </style>
        </div>
      </div>

      <Faqs
        title="Questions fréquentes"
        intro="Réponses sobres sur les packs."
        items={faqs}
        canonical={canonical}
      />

      <Contact />

      <Reassurance variant="offres" />

      <Promo />
    </div>
  </section>

  <Footer />
</BaseLayout>