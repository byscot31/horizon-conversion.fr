---
import Layout from "../../components/Layout.astro";
import { metaDescription } from "../../lib/seo";

const title = "Contact — Horizon Conversion";
const description = metaDescription("Décrivez votre cabinet et vos objectifs. Réponse sous 24–48h ouvrées.");
const url = Astro.url;

const domaine = url.searchParams.get("domaine") ?? "";
const ville = url.searchParams.get("ville") ?? "";

const utm_source = url.searchParams.get("utm_source") ?? "";
const utm_campaign = url.searchParams.get("utm_campaign") ?? "";
---
<Layout title={title} description={description}>
  <h1>Prise de contact</h1>
  <p>Quelques informations suffisent. On revient vers vous avec une première lecture et des pistes actionnables.</p>

  <script is:inline>
      window.__HC = {
        page_source: "{Astro.url.pathname}",
        domaine: "{domaine}",
        ville: "{ville}",
        utm_source: "{utm_source}",
        utm_campaign: "{utm_campaign}"
      };
    </script>

    <script is:inline src="//js-eu1.hsforms.net/forms/embed/v2.js"></script>
    <script is:inline>
      hbspt.forms.create({
        region: "eu1",
        portalId: "XXXXXXX",
        formId: "YYYYYYYY-YYYY-YYYY-YYYY-YYYYYYYYYYYY",
        target: "#hs-form",
        onFormReady: function($form) {
          const data = window.__HC || {};
          for (const [k, v] of Object.entries(data)) {
            const input = $form.querySelector(`[name="${k}"]`);
            if (input) input.value = v;
          }
        }
      });
    </script>
</Layout>