---
// src/components/Blog.astro
import blog from "../data/blog.json";

type HomeItem = {
  slug: string;
  dateLabel: string;
  title: string;
  excerpt: string;
  image: string;
};

const home = (blog as any).home ?? {};
const items = (home.items ?? []) as HomeItem[];

// Sécurité : on force 4 items max (et on évite l'erreur si moins)
const a = items[0];
const b = items[1];
const c = items[2];
const d = items[3];

const href = (slug?: string) => (slug ? `/ressources/${slug}` : "/ressources");
---

<div class="container mw-md mt-6">
  <div class="row g-4 align-items-end blog-cards">
    <div class="col-md-8">
      <div class="p-3 pb-4">
        <div class="before-title text-border-right position-relative text-uppercase ls-3 text-smaller overflow-hidden mb-4 op-04 b-w-50">
          {home.badge ?? "Blog"}
        </div>
        <h2 class="h2 font-secondary fw-bold mb-4 lh-base">
          {home.title ?? "Blog"}
        </h2>
        <p class="mb-5">
          {home.intro ?? ""}
        </p>
      </div>
      <div class="row">
        <div class="col-sm-6">
          <div class="card h-translate-y-sm transform-ts">
            <img src={a?.image ?? "/_assets_/images/blog/1.jpg"} alt="" class="card-img-top" />
            <div class="card-body p-4">
              <div class="h6 mb-3 text-warning">{a?.dateLabel ?? "SEO local"}</div>
              <h3 class="h5 lh-base mb-3 color"><a href={href(a?.slug)}>{a?.title ?? ""}</a></h3>
              <p class="mb-4">{a?.excerpt ?? ""}</p>
              <a href={href(a?.slug)}>Lire <span class="material-symbols-outlined align-middle mb-1" aria-hidden="true">trending_flat</span></a>
            </div>
          </div>
        </div>
        <div class="col-sm-6 mt-4 mt-sm-0">
          <div class="card h-translate-y-sm transform-ts">
            <img src={b?.image ?? "/_assets_/images/blog/2.jpg"} alt="" class="card-img-top" />
            <div class="card-body p-4">
              <div class="h6 mb-3 text-warning">{b?.dateLabel ?? "Refonte"}</div>
              <h3 class="h5 lh-base mb-3 color"><a href={href(b?.slug)}>{b?.title ?? ""}</a></h3>
              <p class="mb-4">{b?.excerpt ?? ""}</p>
              <a href={href(b?.slug)}>Lire <span class="material-symbols-outlined align-middle mb-1" aria-hidden="true">trending_flat</span></a>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="col-md-4">
      <div class="row">
        <div class="col-md-12 col-sm-6">
          <div class="card h-translate-y-sm transform-ts dark mb-4">
            <img src={c?.image ?? "/_assets_/images/blog/3.jpg"} alt="" class="card-img" />
            <a
              href={href(c?.slug)}
              class="card-img-overlay d-flex flex-column justify-content-end p-4"
              style="background-image: linear-gradient(to bottom, rgba(0,0,0,.1), rgba(0,0,0,.3));"
            >
              <div class="h6 mb-3 text-warning">{c?.dateLabel ?? "Prise de contact"}</div>
              <h3 class="h5 lh-base mb-0">{c?.title ?? ""}</h3>
            </a>
          </div>
        </div>
        <div class="col-md-12 col-sm-6">
          <div class="card h-translate-y-sm transform-ts">
            <div class="card-body p-4">
              <div class="h6 mb-3 text-warning">{d?.dateLabel ?? "Mesure"}</div>
              <h3 class="h5 lh-base mb-3 color"><a href={href(d?.slug)}>{d?.title ?? ""}</a></h3>
              <p class="mb-4">{d?.excerpt ?? ""}</p>
              <a href={href(d?.slug)}>Lire <span class="material-symbols-outlined align-middle mb-1" aria-hidden="true">trending_flat</span></a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>