---
// src/components/Services.astro
const { data, page, contexte } = Astro.props;

// data attendu : tableau [{ slug, name, excerpt, icon, bullets }]
const services = Array.isArray(data) ? data : (data?.items ?? []);
if (!services.length) {
  // rien à afficher si vide
  // return null; (Astro n’a pas "return null" direct, donc on gère via condition dans le markup)
}

const sectionTitle = page?.intro?.title ?? "Nos services";
const sectionText = page?.intro?.text ?? "Choisissez le levier le plus adapté à votre situation.";
const ctaLabel = page?.cards?.ctaLabel ?? "Voir le service";
---

{services.length > 0 && (
<div class="section bg-transparent">
  <div class="container">
    <div class="heading-block border-bottom-0 text-center mb-5">
      <h2 class="text-transform-none ls-0">{sectionTitle}</h2>
      <p class="text-muted mb-0">{sectionText}</p>
    </div>

    <div class="row col-mb-30 align-content-stretch">
      {services.map((s) => (
          <div class="col-lg-4 col-md-6 d-flex">
            <a href={`/services/${s.slug}/`} class="card h-shadow h-translate-y-sm all-ts w-100">
              <div class="card-body p-5">
                <div class="feature-box flex-column">
                  <div class="fbox-image mb-5 text-center">
                    <img height="150" src={s.icon ?? "/assets/images/services/seo.svg"} alt={s.name ?? "Service"} />
                  </div>

                  <div class="fbox-content">
                    <h3 class="text-transform-none ls-0 text-larger mb-0">{s.name ?? "Service"}</h3>
                    <p class="text-smaller">{s.excerpt ?? ""}</p>
                  </div>

                  {Array.isArray(s.bullets) && s.bullets.length > 0 && (
                      <ul class="iconlist ms-3 mt-4 mb-0">
                        {s.bullets.slice(0, 5).map((b) => (
                            <li class="d-block mb-2 text-muted">
                              <i class="fa-solid fa-check text-smaller color me-1"></i> {b}
                            </li>
                        ))}
                      </ul>
                  )}

                  <div class="mt-4">
                    <span class="button button-rounded text-capitalize m-0 ls-0">{ctaLabel}</span>
                  </div>
                </div>
              </div>
            </a>
          </div>
      ))}
    </div>

  </div>
</div>
  )}