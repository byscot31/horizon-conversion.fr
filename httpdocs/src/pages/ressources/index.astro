---
// src/pages/ressources/index.astro

import BaseLayout from "../../layouts/BaseLayout.astro";
import { getStaticPageByUrl, getAllArticles, normalizeLinksOut, safeText } from "../../lib/mapping";

import SectionHero from "../../components/SectionHero.astro";
import SectionCTA from "../../components/SectionCTA.astro";
import LinksOut from "../../components/LinksOut.astro";

const page = getStaticPageByUrl("/ressources");

const title = safeText(page?.metaTitle, "Ressources | Horizon Conversion");
const description = safeText(page?.metaDescription, "Guides SEO local, Ads et CRO pour générer des demandes qualifiées.");
const h1 = safeText(page?.h1, "Ressources");

const linksOut = normalizeLinksOut(page?.linksOut);
const articles = getAllArticles();
---

<BaseLayout
  title={title}
  description={description}
  pageContext={{ type: "ressourcesIndex" }}
>
  <SectionHero
    h1={h1}
    intro="Guides concrets : Google Maps, Ads locales, pages qui convertissent, filtrage des mauvais leads."
    bullets={[
      "Actionnable",
      "Orienté demandes",
      "Sans jargon"
    ]}
  />

  <section style="padding:1.5rem 0">
    <div style="max-width:980px;margin:0 auto;padding:0 1rem">
      <h2 style="margin:0 0 .75rem;font-size:1.25rem">Articles</h2>

      <div style="display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:.75rem">
        {articles.map((a: any) => (
          <a
            href={a.url}
            style="border:1px solid #e5e7eb;border-radius:12px;padding:1rem;text-decoration:none;color:#111827;background:#fff"
          >
            <strong style="display:block;margin:0 0 .35rem">{a.h1 || a.metaTitle}</strong>
            <span style="color:#6b7280;font-size:.95rem">{a.metaDescription || ""}</span>
          </a>
        ))}
      </div>
    </div>
  </section>

  <LinksOut links={linksOut} />
  <SectionCTA />
</BaseLayout>