---
// src/pages/services/[service].astro
import BaseLayout from "../../layouts/BaseLayout.astro";
import { services, bySlug } from "../../lib/data";
import { buildModel } from "../../lib/pageModel";

import PageTitle from "../../components/PageTitle.astro";
import HeroBenefices from "../../components/HeroBenefices.astro";
import Methode from "../../components/Methode.astro";
import Preuves from "../../components/Preuves.astro";
import Faqs from "../../components/Faqs.astro";
import ContactForm from "../../components/ContactForm.astro";
import Tarifs from "../../components/Tarifs.astro";
import Ressources from "../../components/Ressources.astro";
import ZonesVilles from "../../components/ZonesVilles.astro";

export function getStaticPaths() {
  return (services ?? []).map((s) => ({ params: { service: s.slug } }));
}

const service = bySlug(services, Astro.params.service);

const model = buildModel({
  type: "service",
  service,
  canonical: `/services/${service.slug}/`,
});

const contexte = model.contexte;
---

<BaseLayout seo={model.seo} site={model.site}>
  <PageTitle contexte={contexte} seo={model.seo} breadcrumbItems={model.breadcrumbItems} />

  <section id="content">
    <div class="content-wrap pb-0">

      <div class="container mb-5">
        <HeroBenefices heroData={model.hero.page} beneficesData={model.blocks.benefices} contexte={contexte} />
      </div>

      <div class="clear"></div>

      <Tarifs data={model.blocks.tarifs} contexte={contexte} />

      <Preuves data={model.blocks.preuves} contexte={contexte} />

      <Methode data={model.blocks.methode} contexte={contexte} />

      <ZonesVilles data={{ zones: model.blocks.zones, villes: model.blocks.villes }} contexte={contexte} />

      <Ressources data={model.blocks.articles} contexte={contexte} />

      <Faqs
          items={model.faqs}
          data={{ badge: "FAQ", title: "Questions fréquentes", intro: "Réponses simples et concrètes." }}
          contexte={contexte}
      />

      <ContactForm data={model.cta} form={model.blocks.form} contexte={contexte} mode="audit" />

    </div>
  </section>
</BaseLayout>
