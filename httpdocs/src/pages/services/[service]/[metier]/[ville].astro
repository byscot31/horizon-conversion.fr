---
// src/pages/services/[service]/[metier]/[ville].astro
import Layout from "../../../../layouts/Layout.astro";
import services from "../../../../data/services.json";
import metiers from "../../../../data/metiers.json";
import villes from "../../../../data/villes.json";
import intentions from "../../../../data/intentions.json";
import IntentionAnimation from "../../../../components/IntentionAnimation.astro";

export async function getStaticPaths() {
  const paths = [];
  for (const service of services) {
    for (const metier of metiers) {
      for (const ville of villes) {
        paths.push({
          params: {
            service: service.id,
            metier: metier.id,
            ville: ville.id
          },
          props: { service, metier, ville }
        });
      }
    }
  }
  return paths;
}

const { service, metier, ville } = Astro.props;

// DonnÃ©es d'intention (transactionnelle pour les pages reines)
const intentionData = intentions[metier.id]?.intentions?.transactionnelle || {
  description: `Vous cherchez un expert en ${service.nomCourt} pour votre activitÃ© de ${metier.nomCourt} Ã  ${ville.nom} ?`,
  cta: "Obtenir un audit gratuit",
  urgence: "haute"
};

const persona = intentions[metier.id]?.persona || {
  nom: "nos clients",
  citation: "Je veux Ãªtre plus visible dans ma ville.",
  histoire: "Comme beaucoup de professionnels, vous cherchez Ã  attirer plus de clients locaux."
};

// Autres villes pour ce mÃªme service+mÃ©tier
const autresVilles = villes.filter(v => v.id !== ville.id).slice(0, 8);

// Autres services pour ce mÃªme mÃ©tier dans cette ville
const autresServices = services.filter(s => s.id !== service.id).slice(0, 4);

// Titre et description
const titre = `${service.nom} pour ${metier.nomCourt} Ã  ${ville.nom}`;
const description = intentionData.description;
---

<Layout title={titre} description={description}>
  <!-- Fil d'Ariane -->
  <nav class="container-custom py-4 text-sm text-gray-600">
    <ol class="flex items-center space-x-2">
      <li><a href="/" class="hover:text-primary-600">Accueil</a></li>
      <li class="text-gray-400">â€º</li>
      <li><a href="/services" class="hover:text-primary-600">Services</a></li>
      <li class="text-gray-400">â€º</li>
      <li><a href={`/services/${service.id}`} class="hover:text-primary-600">{service.nomCourt}</a></li>
      <li class="text-gray-400">â€º</li>
      <li><a href={`/services/${service.id}/${metier.id}`} class="hover:text-primary-600">{metier.nomCourt}</a></li>
      <li class="text-gray-400">â€º</li>
      <li class="text-gray-900 font-medium">{ville.nom}</li>
    </ol>
  </nav>

  <!-- Hero avec intention transactionnelle -->
  <section class="relative bg-gradient-to-r from-primary-600 to-primary-800 text-white overflow-hidden">
    {intentionData.urgence === 'haute' && (
        <div class="absolute top-4 right-4">
          <IntentionAnimation intention="transactionnelle" type="badge">
            âš¡ INTERVENTION RAPIDE
          </IntentionAnimation>
        </div>
    )}

    <div class="container-custom py-20 relative z-10">
      <div class="max-w-4xl mx-auto text-center">
        <h1 class="text-5xl md:text-6xl font-bold mb-6">{titre}</h1>

        <!-- Accroche persona -->
        <div class="bg-white/10 backdrop-blur-sm p-6 rounded-xl mb-8">
          <div class="flex items-center justify-center gap-4">
            <div class="w-16 h-16 bg-white/20 rounded-full flex items-center justify-center flex-shrink-0 text-3xl">
              ğŸ‘¤
            </div>
            <div class="text-left">
              <p class="text-lg font-medium mb-1">Comme {persona.nom}, {metier.nomCourt} Ã  {ville.nom}...</p>
              <p class="text-white/90 italic">"{persona.citation}"</p>
            </div>
          </div>
        </div>

        <p class="text-2xl mb-8 text-white/90">{intentionData.description}</p>

        <!-- CTA principal -->
        <div class="flex flex-col sm:flex-row gap-4 justify-center">
          <IntentionAnimation intention="transactionnelle" type="button" class="text-lg px-8 py-4">
            <a href="/contact" class="flex items-center gap-2">
              <span>ğŸ“</span>
              <span>{intentionData.cta}</span>
            </a>
          </IntentionAnimation>

          <a href={`/etudes-de-cas/${metier.id === 'artisans' ? 'plombier-meru' :
            metier.id === 'commerces' ? 'caviste-cergy' :
              metier.id === 'profession-liberale' ? 'avocat-montmorency' :
                metier.id === 'tpe-pme' ? 'transport-compiegne' :
                  metier.id === 'reseaux-franchise' ? 'franchise-cergy' : 'hotel-chantilly'}`}
             class="bg-white text-primary-600 hover:bg-gray-100 px-8 py-4 rounded-full font-semibold text-lg transition-colors">
            Voir un cas concret
          </a>
        </div>

        <p class="text-sm mt-4 text-white/80">
          Ou appelez-moi directement : <a href="tel:0660921008" class="font-bold underline">06 60 92 10 08</a>
        </p>
      </div>
    </div>
  </section>

  <!-- SECTION 1 : Pourquoi c'est important ici -->
  <section class="py-20">
    <div class="container-custom">
      <div class="grid md:grid-cols-2 gap-12 items-center">
        <div>
          <h2 class="text-3xl font-bold mb-6">
            Pourquoi les {metier.nomCourt} Ã  {ville.nom} ont besoin de {service.nomCourt}
          </h2>
          <p class="text-lg text-gray-700 mb-6">
            {ville.description || `Ã€ ${ville.nom} et dans ses environs, la concurrence est rÃ©elle.`}
          </p>
          <ul class="space-y-3">
            <li class="flex items-start gap-2">
              <span class="text-primary-600 text-xl">âœ“</span>
              <span><strong>Concurrence locale</strong> â€“ {ville.alentours.length} communes autour cherchent des {metier.nomCourt}</span>
            </li>
            <li class="flex items-start gap-2">
              <span class="text-primary-600 text-xl">âœ“</span>
              <span><strong>VisibilitÃ© immÃ©diate</strong> â€“ Apparaissez dans le pack Google local</span>
            </li>
            <li class="flex items-start gap-2">
              <span class="text-primary-600 text-xl">âœ“</span>
              <span><strong>Clients qualifiÃ©s</strong> â€“ Ceux qui cherchent prÃ¨s de chez vous</span>
            </li>
          </ul>
        </div>
        <div class="bg-gray-50 p-8 rounded-xl">
          <h3 class="text-2xl font-bold mb-4">Ce que je vous propose</h3>
          <ul class="space-y-3 mb-6">
            <li class="flex items-start gap-2">ğŸ“Š Audit gratuit de votre visibilitÃ© Ã  {ville.nom}</li>
            <li class="flex items-start gap-2">ğŸ¯ StratÃ©gie sur-mesure pour les {metier.nomCourt}</li>
            <li class="flex items-start gap-2">ğŸ“ Ciblage des {ville.alentours.length} communes alentours</li>
          </ul>
          <a href="/methodologie" class="text-primary-600 hover:underline">DÃ©couvrir ma mÃ©thode â†’</a>
        </div>
      </div>
    </div>
  </section>

  <!-- SECTION 2 : Villes alentours -->
  <section class="bg-gray-50 py-16">
    <div class="container-custom">
      <h2 class="text-3xl font-bold text-center mb-4">J'interviens aussi dans les environs</h2>
      <p class="text-center text-gray-600 mb-8">Je me dÃ©place dans toutes ces communes proches de {ville.nom}.</p>

      <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-3 max-w-4xl mx-auto">
        {ville.alentours.map(alentour => {
          const nomAlentour = typeof alentour === 'string' ? alentour.split(' (')[0] : alentour;
          return (
              <div class="bg-white p-3 rounded-lg text-center border border-gray-100 hover:shadow-sm">
                <div class="font-medium">{nomAlentour}</div>
                <div class="text-xs text-gray-500 mt-1">intervention possible</div>
              </div>
          );
        })}
      </div>
    </div>
  </section>

  <!-- SECTION 3 : Autres villes pour ce service+mÃ©tier -->
  <section class="py-16">
    <div class="container-custom">
      <h3 class="text-xl font-bold text-center mb-6">Ã‰galement disponible dans d'autres villes</h3>
      <div class="flex flex-wrap justify-center gap-3">
        {autresVilles.map(autreVille => (
            <a
                href={`/services/${service.id}/${metier.id}/${autreVille.id}`}
                class="bg-gray-100 px-4 py-2 rounded-full text-sm hover:bg-primary-100 hover:text-primary-600 transition-colors"
            >
              {autreVille.nom}
            </a>
        ))}
        <a href="/villes" class="bg-primary-50 text-primary-600 px-4 py-2 rounded-full text-sm hover:bg-primary-100 transition-colors">
          Toutes les villes
        </a>
      </div>
    </div>
  </section>

  <!-- SECTION 4 : Autres services pour ce mÃ©tier dans cette ville -->
  <section class="bg-gray-50 py-20">
    <div class="container-custom">
      <h2 class="text-3xl font-bold text-center mb-4">D'autres services pour les {metier.nomCourt} Ã  {ville.nom}</h2>
      <p class="text-center text-gray-600 mb-12">ComplÃ©tez votre stratÃ©gie avec ces solutions.</p>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 max-w-5xl mx-auto">
        {autresServices.map(autreService => (
            <a
                href={`/services/${autreService.id}/${metier.id}/${ville.id}`}
                class="bg-white p-6 rounded-xl border border-gray-100 hover:shadow-md transition-all group"
            >
              <h3 class="text-lg font-bold mb-2 group-hover:text-primary-600">{autreService.nom}</h3>
              <p class="text-sm text-gray-600 mb-3">{autreService.description}</p>
              <span class="text-primary-600 text-sm group-hover:translate-x-2 transition-transform inline-block">
              DÃ©couvrir â†’
            </span>
            </a>
        ))}
      </div>
    </div>
  </section>

  <!-- SECTION 5 : TÃ©moignages clients (preuve sociale) -->
  <section class="py-20 bg-gray-50">
    <div class="container-custom">
      <h2 class="text-3xl font-bold text-center mb-4">Ils nous ont fait confiance</h2>
      <p class="text-center text-gray-600 mb-12">DÃ©couvrez ce que disent d'autres {metier.nomCourt} comme vous.</p>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-8 max-w-6xl mx-auto">

        <!-- TÃ‰MOIGNAGE 1 : Persona principal -->
        <div class="bg-white p-6 rounded-2xl shadow-md hover:shadow-lg transition-all">
          <div class="flex items-start gap-4 mb-4">
            <div class="w-16 h-16 bg-primary-100 rounded-full flex items-center justify-center flex-shrink-0 text-2xl">
              ğŸ‘¤
            </div>
            <div>
              <p class="font-semibold text-lg">{persona.nom}</p>
              <p class="text-sm text-gray-600">{persona.entreprise}</p>
              <p class="text-xs text-gray-500">
                {metier.id === 'artisans' ? 'MÃ©ru' :
                  metier.id === 'commerces' ? 'Cergy' :
                    metier.id === 'profession-liberale' ? 'Montmorency' :
                      metier.id === 'tpe-pme' ? 'CompiÃ¨gne' :
                        metier.id === 'reseaux-franchise' ? 'Cergy' : 'Chantilly'}
              </p>
            </div>
          </div>

          <div class="mb-3 text-yellow-400 text-lg">
            â˜…â˜…â˜…â˜…â˜…
          </div>

          <blockquote class="text-gray-700 italic mb-4">
            "{persona.citation}"
          </blockquote>

          <div class="mt-3 text-green-700 font-bold">
            {metier.id === 'artisans' && "+650% d'appels"}
            {metier.id === 'commerces' && "+30% de clients"}
            {metier.id === 'profession-liberale' && "+200% de rendez-vous"}
            {metier.id === 'tpe-pme' && "+150% de devis"}
            {metier.id === 'reseaux-franchise' && "+450 avis"}
            {metier.id === 'tourisme' && "+80% rÃ©servations directes"}
          </div>

          <a href={`/etudes-de-cas/${
            metier.id === 'artisans' ? 'plombier-meru' :
              metier.id === 'commerces' ? 'caviste-cergy' :
                metier.id === 'profession-liberale' ? 'avocat-montmorency' :
                  metier.id === 'tpe-pme' ? 'transport-compiegne' :
                    metier.id === 'reseaux-franchise' ? 'franchise-cergy' : 'hotel-chantilly'
          }`} class="inline-block mt-4 text-primary-600 text-sm hover:underline">
            Voir son histoire â†’
          </a>
        </div>

        <!-- TÃ‰MOIGNAGE 2 : Second client (mÃªme mÃ©tier, autre ville) -->
        <div class="bg-white p-6 rounded-2xl shadow-md hover:shadow-lg transition-all">
          <div class="flex items-start gap-4 mb-4">
            <div class="w-16 h-16 bg-primary-100 rounded-full flex items-center justify-center flex-shrink-0 text-2xl">
              {metier.id === 'artisans' && 'ğŸ”§'}
              {metier.id === 'commerces' && 'ğŸ·'}
              {metier.id === 'profession-liberale' && 'âš–ï¸'}
              {metier.id === 'tpe-pme' && 'ğŸš›'}
              {metier.id === 'reseaux-franchise' && 'ğŸ¥–'}
              {metier.id === 'tourisme' && 'ğŸ¨'}
            </div>
            <div>
              <p class="font-semibold text-lg">
                {metier.id === 'artisans' && "Jean-Claude Lefebvre"}
                {metier.id === 'commerces' && "Isabelle Mercier"}
                {metier.id === 'profession-liberale' && "Dr. Martin"}
                {metier.id === 'tpe-pme' && "Philippe Durand"}
                {metier.id === 'reseaux-franchise' && "Franck Moreau"}
                {metier.id === 'tourisme' && "Pierre Lambert"}
              </p>
              <p class="text-sm text-gray-600">
                {metier.id === 'artisans' && "Lefebvre Ã‰lectricitÃ©"}
                {metier.id === 'commerces' && "Coiffure Isabelle"}
                {metier.id === 'profession-liberale' && "MÃ©decine gÃ©nÃ©rale"}
                {metier.id === 'tpe-pme' && "Menuiserie Durand"}
                {metier.id === 'reseaux-franchise' && "Optical Center"}
                {metier.id === 'tourisme' && "GÃ®tes du Val-d'Oise"}
              </p>
              <p class="text-xs text-gray-500">
                {metier.id === 'artisans' && "Beauvais"}
                {metier.id === 'commerces' && "Argenteuil"}
                {metier.id === 'profession-liberale' && "Senlis"}
                {metier.id === 'tpe-pme' && "Creil"}
                {metier.id === 'reseaux-franchise' && "Pontoise"}
                {metier.id === 'tourisme' && "Compiegne"}
              </p>
            </div>
          </div>

          <div class="mb-3 text-yellow-400 text-lg">
            â˜…â˜…â˜…â˜…â˜…
          </div>

          <blockquote class="text-gray-700 italic mb-4">
            "{metier.id === 'artisans' && "Aujourd'hui, je suis dans le top 3 sur les mots-clÃ©s importants de ma rÃ©gion."}
            {metier.id === 'commerces' && "Les clients me trouvent directement sur Google Maps, je ne peux plus m'en passer."}
            {metier.id === 'profession-liberale' && "Mon taux de rendez-vous a doublÃ© en seulement 3 mois."}
            {metier.id === 'tpe-pme' && "Nous avons dÃ©crochÃ© 3 contrats majeurs grÃ¢ce Ã  notre nouvelle visibilitÃ©."}
            {metier.id === 'reseaux-franchise' && "La gestion centralisÃ©e nous fait gagner un temps prÃ©cieux."}
            {metier.id === 'tourisme' && "Je reÃ§ois des rÃ©servations directes chaque semaine."}"
          </blockquote>

          <div class="mt-3 text-green-700 font-bold">
            {metier.id === 'artisans' && "+400% de visibilitÃ©"}
            {metier.id === 'commerces' && "+25% de passages"}
            {metier.id === 'profession-liberale' && "+180% de contacts"}
            {metier.id === 'tpe-pme' && "+200% de trafic"}
            {metier.id === 'reseaux-franchise' && "+300 avis"}
            {metier.id === 'tourisme' && "+50% de nuitÃ©es"}
          </div>

          <a href={`/etudes-de-cas/${
            metier.id === 'artisans' ? 'plombier-meru' :
              metier.id === 'commerces' ? 'caviste-cergy' :
                metier.id === 'profession-liberale' ? 'avocat-montmorency' :
                  metier.id === 'tpe-pme' ? 'transport-compiegne' :
                    metier.id === 'reseaux-franchise' ? 'franchise-cergy' : 'hotel-chantilly'
          }`} class="inline-block mt-4 text-primary-600 text-sm hover:underline">
            Voir son histoire â†’
          </a>
        </div>

        <!-- TÃ‰MOIGNAGE 3 : TroisiÃ¨me client (variÃ©tÃ©) -->
        <div class="bg-white p-6 rounded-2xl shadow-md hover:shadow-lg transition-all">
          <div class="flex items-start gap-4 mb-4">
            <div class="w-16 h-16 bg-primary-100 rounded-full flex items-center justify-center flex-shrink-0 text-2xl">
              {metier.id === 'artisans' && 'ğŸ”¨'}
              {metier.id === 'commerces' && 'ğŸ’'}
              {metier.id === 'profession-liberale' && 'ğŸ“œ'}
              {metier.id === 'tpe-pme' && 'ğŸ—ï¸'}
              {metier.id === 'reseaux-franchise' && 'ğŸ '}
              {metier.id === 'tourisme' && 'ğŸ›ï¸'}
            </div>
            <div>
              <p class="font-semibold text-lg">
                {metier.id === 'artisans' && "Michel Dubois"}
                {metier.id === 'commerces' && "CÃ©line Petit"}
                {metier.id === 'profession-liberale' && "MaÃ®tre Petit"}
                {metier.id === 'tpe-pme' && "SARL BTP 60"}
                {metier.id === 'reseaux-franchise' && "RÃ©seau immobilier"}
                {metier.id === 'tourisme' && "Chambres d'hÃ´tes"}
              </p>
              <p class="text-sm text-gray-600">
                {metier.id === 'artisans' && "Menuiserie Dubois"}
                {metier.id === 'commerces' && "Fleuriste CÃ©line"}
                {metier.id === 'profession-liberale' && "Ã‰tude notariale"}
                {metier.id === 'tpe-pme' && "Construction BTP"}
                {metier.id === 'reseaux-franchise' && "Century 21"}
                {metier.id === 'tourisme' && "La Maison Bleue"}
              </p>
              <p class="text-xs text-gray-500">
                {metier.id === 'artisans' && "Chambly"}
                {metier.id === 'commerces' && "Cergy"}
                {metier.id === 'profession-liberale' && "Chantilly"}
                {metier.id === 'tpe-pme' && "Noyon"}
                {metier.id === 'reseaux-franchise' && "Beaumont"}
                {metier.id === 'tourisme' && "Senlis"}
              </p>
            </div>
          </div>

          <div class="mb-3 text-yellow-400 text-lg">
            â˜…â˜…â˜…â˜…â˜…
          </div>

          <blockquote class="text-gray-700 italic mb-4">
            "{metier.id === 'artisans' && "Mon tÃ©lÃ©phone sonne constamment, je dois refuser des chantiers."}
            {metier.id === 'commerces' && "Je fais 40% de chiffre en plus le week-end."}
            {metier.id === 'profession-liberale' && "Je n'ai plus besoin de faire de publicitÃ© traditionnelle."}
            {metier.id === 'tpe-pme' && "Notre chiffre d'affaires a augmentÃ© de 40%."}
            {metier.id === 'reseaux-franchise' && "La satisfaction client a explosÃ©."}
            {metier.id === 'tourisme' && "Booking ne reprÃ©sente plus que 30% de mon CA."}"
          </blockquote>

          <div class="mt-3 text-green-700 font-bold">
            {metier.id === 'artisans' && "+500% de devis"}
            {metier.id === 'commerces' && "+35% de ventes"}
            {metier.id === 'profession-liberale' && "+150% de consultations"}
            {metier.id === 'tpe-pme' && "+3Mâ‚¬ de CA"}
            {metier.id === 'reseaux-franchise' && "+40% de visibilitÃ©"}
            {metier.id === 'tourisme' && "90% de rÃ©servations directes"}
          </div>

          <a href={`/etudes-de-cas/${
            metier.id === 'artisans' ? 'plombier-meru' :
              metier.id === 'commerces' ? 'caviste-cergy' :
                metier.id === 'profession-liberale' ? 'avocat-montmorency' :
                  metier.id === 'tpe-pme' ? 'transport-compiegne' :
                    metier.id === 'reseaux-franchise' ? 'franchise-cergy' : 'hotel-chantilly'
          }`} class="inline-block mt-4 text-primary-600 text-sm hover:underline">
            Voir son histoire â†’
          </a>
        </div>
      </div>

      <div class="text-center mt-12">
        <a href="/etudes-de-cas" class="text-primary-600 hover:underline font-medium">
          Voir toutes les Ã©tudes de cas â†’
        </a>
      </div>
    </div>
  </section>

  <!-- SECTION 6 : Ressources associÃ©es -->
  <section class="bg-gray-50 py-20">
    <div class="container-custom">
      <h2 class="text-3xl font-bold text-center mb-4">Ressources pour les {metier.nomCourt} Ã  {ville.nom}</h2>
      <p class="text-center text-gray-600 mb-12">Guides et articles pour approfondir.</p>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-6 max-w-4xl mx-auto">
        <!-- Guide SEO local -->
        <a href="/ressources/guides/seo-local-artisans-2025" class="bg-white p-6 rounded-xl border border-gray-100 hover:shadow-md transition-all">
          <div class="text-3xl mb-3">ğŸ“˜</div>
          <h3 class="font-bold mb-2">Guide SEO local pour {metier.nomCourt}</h3>
          <p class="text-sm text-gray-600 mb-3">Toutes les clÃ©s pour Ãªtre visible dans votre ville.</p>
          <span class="text-primary-600 text-sm">TÃ©lÃ©charger â†’</span>
        </a>

        <!-- Article avis Google -->
        <a href="/ressources/blog/avis-google-importance" class="bg-white p-6 rounded-xl border border-gray-100 hover:shadow-md transition-all">
          <div class="text-3xl mb-3">ğŸ“</div>
          <h3 class="font-bold mb-2">Pourquoi les avis sont cruciaux</h3>
          <p class="text-sm text-gray-600 mb-3">Comment obtenir plus d'avis et mieux convertir.</p>
          <span class="text-primary-600 text-sm">Lire l'article â†’</span>
        </a>

        <!-- Formation -->
        <a href="/services/formation" class="bg-white p-6 rounded-xl border border-gray-100 hover:shadow-md transition-all">
          <div class="text-3xl mb-3">ğŸ“</div>
          <h3 class="font-bold mb-2">Formation SEO pour {metier.nomCourt}</h3>
          <p class="text-sm text-gray-600 mb-3">Devenez autonome sur votre rÃ©fÃ©rencement.</p>
          <span class="text-primary-600 text-sm">En savoir plus â†’</span>
        </a>
      </div>
    </div>
  </section>

  <!-- SECTION 7 : FAQ spÃ©cifique -->
  <section class="py-20">
    <div class="container-custom max-w-3xl">
      <h2 class="text-3xl font-bold text-center mb-4">Questions frÃ©quentes</h2>
      <p class="text-center text-gray-600 mb-12">Sur le {service.nom} pour les {metier.nomCourt} Ã  {ville.nom}.</p>

      <div class="space-y-4">
        <details class="bg-gray-50 p-6 rounded-lg">
          <summary class="font-semibold cursor-pointer">Combien de temps pour voir des rÃ©sultats Ã  {ville.nom} ?</summary>
          <p class="mt-3 text-gray-600">Les premiers rÃ©sultats apparaissent gÃ©nÃ©ralement entre 1 et 3 mois. Pour les {metier.nomCourt} Ã  {ville.nom}, on voit souvent des amÃ©liorations rapides sur Google My Business.</p>
        </details>

        <details class="bg-gray-50 p-6 rounded-lg">
          <summary class="font-semibold cursor-pointer">Quel budget pour un {metier.nomCourt} Ã  {ville.nom} ?</summary>
          <p class="mt-3 text-gray-600">Je propose des devis personnalisÃ©s aprÃ¨s un audit gratuit. Pour {ville.nom}, comptez entre 300â‚¬ et 800â‚¬ par mois selon vos objectifs.</p>
        </details>

        <details class="bg-gray-50 p-6 rounded-lg">
          <summary class="font-semibold cursor-pointer">Intervenez-vous aussi dans les villages autour ?</summary>
          <p class="mt-3 text-gray-600">Oui ! Je me dÃ©place dans toutes les communes autour de {ville.nom} : {ville.alentours.slice(0, 3).map(a => typeof a === 'string' ? a.split(' (')[0] : a).join(', ')} et bien d'autres.</p>
        </details>
      </div>

      <div class="text-center mt-8">
        <a href="/ressources/faq" class="text-primary-600 hover:underline">
          Voir toutes les FAQ â†’
        </a>
      </div>
    </div>
  </section>

  <!-- SECTION 8 : Autres mÃ©tiers dans cette ville -->
  <section class="bg-gray-50 py-16">
    <div class="container-custom">
      <h3 class="text-lg font-semibold text-center mb-6">Ce service Ã  {ville.nom} pour d'autres mÃ©tiers</h3>
      <div class="flex flex-wrap justify-center gap-3">
        {metiers.filter(m => m.id !== metier.id).slice(0, 5).map(autreMetier => (
            <a
                href={`/services/${service.id}/${autreMetier.id}/${ville.id}`}
                class="bg-white px-4 py-2 rounded-full text-sm hover:bg-primary-100 hover:text-primary-600 transition-colors"
            >
              {autreMetier.nomCourt}
            </a>
        ))}
        <a href="/metiers" class="bg-primary-50 text-primary-600 px-4 py-2 rounded-full text-sm hover:bg-primary-100 transition-colors">
          Tous les mÃ©tiers
        </a>
      </div>
    </div>
  </section>

  <!-- SECTION 9 : CTA final -->
  <section class="bg-primary-600 text-white py-20">
    <div class="container-custom text-center max-w-3xl">
      <h2 class="text-4xl font-bold mb-4">
        Vous Ãªtes {metier.nomCourt} Ã  {ville.nom} ?
      </h2>
      <p class="text-xl mb-8 opacity-90">
        Je vous propose un audit gratuit pour analyser votre visibilitÃ© locale et voir comment attirer plus de clients.
      </p>

      <div class="flex flex-col sm:flex-row gap-4 justify-center">
        <a href="/contact" class="bg-white text-primary-600 hover:bg-gray-100 px-8 py-4 rounded-full font-semibold text-lg transition-colors">
          Demander mon audit gratuit
        </a>
        <a href="tel:0660921008" class="bg-transparent border-2 border-white text-white hover:bg-white/10 px-8 py-4 rounded-full font-semibold text-lg transition-colors">
          ğŸ“ 06 60 92 10 08
        </a>
      </div>

      <p class="text-sm mt-6 text-white/80">
        Disponible 7j/7 â€¢ Intervention rapide dans le {ville.zone === "60" ? "60" : "95"}
      </p>
    </div>
  </section>

  <!-- CTA flottant mobile -->
  <div class="fixed bottom-0 left-0 right-0 bg-white shadow-lg p-4 md:hidden z-50 border-t border-primary-200">
    <div class="flex gap-4">
      <a href="tel:0660921008" class="flex-1 bg-primary-600 text-white py-3 rounded-full font-bold text-center">
        ğŸ“ APPELER
      </a>
      <a href="/contact" class="flex-1 bg-primary-600 text-white py-3 rounded-full font-bold text-center">
        AUDIT GRATUIT
      </a>
    </div>
  </div>
</Layout>