---
import metiers from "../../../../data/metiers.json";
import services from "../../../../data/services.json";
import villes from "../../../../data/villes.json";

const metierSlugs = new Set(metiers.map((m) => m.slug));

// Si tu veux limiter au lancement aux villes "A" :
// const buildVilles = villes.filter((v) => v.priority === "A");
const buildVilles = villes;

/** @type {import("astro").GetStaticPaths} */
export function getStaticPaths() {
  return services
    .filter((s) => metierSlugs.has(s.metier))
    .flatMap((s) =>
      buildVilles.map((v) => ({
        params: { metier: s.metier, service: s.slug, ville: v.slug },
        props: { service: s, ville: v },
      }))
    );
}

// Exemple dâ€™usage
const { service, ville } = Astro.props;
---
