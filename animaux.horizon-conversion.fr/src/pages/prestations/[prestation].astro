---
import LayoutSEO from "../../layouts/LayoutSEO.astro";
import { PRESTATIONS, type PrestationKey } from "../../data/prestations.ts";

export const prerender = true;

const baseUrl = "https://animaux.horizon-conversion.fr";

export function getStaticPaths() {
  return Object.keys(PRESTATIONS).map((prestation) => ({ params: { prestation } }));
}

const { prestation } = Astro.params as { prestation: PrestationKey };
const offer = PRESTATIONS[prestation];

if (!offer) throw new Error(`Prestation inconnue: ${prestation}`);

const canonical = `${baseUrl}${Astro.url.pathname}`;

const title = `${offer.name} | Prestations – Horizon Conversion Animaux`;
const description = `Prestation : ${offer.name}. ${offer.headline} (Sud Oise 60 / Val d’Oise 95).`;

const breadcrumbs = [
  { name: "Accueil", item: `${baseUrl}/` },
  { name: "Prestations", item: `${baseUrl}/prestations/` },
  { name: offer.name, item: canonical },
];

const faqJsonLd = {
  "@context": "https://schema.org",
  "@type": "FAQPage",
  mainEntity: (offer.faq || []).map((f) => ({
    "@type": "Question",
    name: f.q,
    acceptedAnswer: { "@type": "Answer", text: f.a },
  })),
};

const jsonLd = [
  {
    "@context": "https://schema.org",
    "@type": "WebPage",
    name: title,
    url: canonical,
    description,
    isPartOf: { "@type": "WebSite", name: "Horizon Conversion Animaux", url: baseUrl },
  },
  {
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    itemListElement: breadcrumbs.map((b, i) => ({
      "@type": "ListItem",
      position: i + 1,
      name: b.name,
      item: b.item,
    })),
  },
  {
    "@context": "https://schema.org",
    "@type": "Service",
    name: offer.name,
    areaServed: ["Sud Oise (60)", "Val d’Oise (95)"],
    provider: {
      "@type": "Organization",
      name: "Horizon Conversion Animaux",
      url: baseUrl,
      telephone: "+33660921008",
      email: "contact@horizon-conversion.fr",
    },
  },
  faqJsonLd,
];
---

<LayoutSEO
  title={title}
  description={description}
  baseUrl={baseUrl}
  canonical={canonical}
  ogType="website"
  ogImage={`${baseUrl}/og/prestations-${prestation}.jpg`}
  ogImageAlt={`Prestation – ${offer.name}`}
  breadcrumbs={breadcrumbs}
  jsonLd={jsonLd}
>

<style>
  :global(body){margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial;color:#0f172a;background:#fff}
  .wrap{max-width:1040px;margin:0 auto;padding:28px 16px 72px}
  .breadcrumbs{font-size:14px;color:#475569;margin:4px 0 18px}
  .breadcrumbs a{color:inherit;text-decoration:none}
  header.hero{border:1px solid #e2e8f0;border-radius:18px;background:linear-gradient(180deg,#f8fafc,#fff);padding:22px;display:grid;gap:10px}
  h1{margin:0;font-size:34px;line-height:1.1;letter-spacing:-0.02em}
  .sub{margin:0;color:#334155;max-width:90ch;line-height:1.6}
  .grid{margin-top:18px;display:grid;grid-template-columns:1.15fr .85fr;gap:18px;align-items:start}
  @media (max-width:920px){.grid{grid-template-columns:1fr}}
  .card{border:1px solid #e2e8f0;border-radius:18px;padding:18px;background:#fff;box-shadow:0 6px 20px rgba(15,23,42,.06)}
  h2{margin:0 0 10px;font-size:18px}
  p{margin:0;color:#334155;line-height:1.6}
  ul{margin:10px 0 0;padding-left:18px;color:#334155;line-height:1.55}
  .badge{display:inline-block;font-size:12px;padding:6px 10px;border-radius:999px;border:1px solid #e2e8f0;background:#f1f5f9;color:#334155;font-weight:900;width:fit-content}
  .pills{display:flex;flex-wrap:wrap;gap:8px;margin-top:10px}
  .pill{display:inline-block;font-size:12px;padding:6px 10px;border-radius:999px;border:1px solid #e2e8f0;background:#fff;color:#334155}
  .kpis{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:10px;margin-top:12px}
  .kpi{border:1px solid #e2e8f0;border-radius:16px;background:#f8fafc;padding:12px}
  .kpi strong{display:block;font-size:14px}
  .kpi span{display:block;font-size:12px;color:#64748b;margin-top:2px}
  .ctaRow{margin-top:14px;display:grid;grid-template-columns:1fr 1fr;gap:12px}
  @media (max-width:720px){.ctaRow{grid-template-columns:1fr}}
  .btn{display:inline-flex;align-items:center;justify-content:center;padding:12px 14px;border-radius:14px;border:1px solid #0f172a;background:#0f172a;color:#fff;cursor:pointer;font-weight:900;text-decoration:none}
  .btn.secondary{background:#fff;color:#0f172a}
  .faq{margin-top:16px}
  .faq details{border:1px solid #e2e8f0;border-radius:16px;padding:12px 14px;background:#fff;margin-bottom:10px}
  .faq summary{cursor:pointer;font-weight:900}
  .faq p{margin:10px 0 0}
  .meta{color:#475569;font-size:14px;line-height:1.6;margin-top:10px}
</style>

<div class="wrap">
  <nav class="breadcrumbs" aria-label="Fil d’Ariane">
    <a href="/">Accueil</a> <span aria-hidden="true">›</span>{" "}
    <a href="/prestations/">Prestations</a> <span aria-hidden="true">›</span>{" "}
    <span>{offer.name}</span>
  </nav>

  <header class="hero">
    <span class="badge">{offer.badge}</span>
    <h1>{offer.name}</h1>
    <p class="sub">
      {offer.headline} Zones prioritaires : <strong>Sud Oise (60)</strong> &{" "}
      <strong>Val d’Oise (95)</strong>.
    </p>
  </header>

  <section class="grid">
    <div class="card">
      <h2>Pourquoi cette prestation</h2>
      <p>On cible une seule chose : des demandes utiles (RDV, devis, réservations) — pas du volume.</p>

      <div class="pills" aria-label="Pour qui">
        {(offer.forWho || []).map((x) => <span class="pill">{x}</span>)}
      </div>

      <h2 style="margin-top:16px;">Problèmes fréquents</h2>
      <ul>{(offer.pains || []).map((x) => <li>{x}</li>)}</ul>

      <h2 style="margin-top:16px;">Résultats visés</h2>
      <ul>{(offer.outcomes || []).map((x) => <li>{x}</li>)}</ul>

      <h2 style="margin-top:16px;">Ce que vous recevez</h2>
      <ul>{(offer.deliverables || []).map((x) => <li>{x}</li>)}</ul>

      <div class="ctaRow">
        <a class="btn" href="/contact/">Demander un diagnostic</a>
        <a class="btn secondary" href="tel:+33660921008">Appeler : 06 60 92 10 08</a>
      </div>

      <p class="meta">
        Email :{" "}
        <a
          href="mailto:contact@horizon-conversion.fr"
          style="color:#0f172a;text-decoration:none;border-bottom:1px solid rgba(15,23,42,.2);"
        >
          contact@horizon-conversion.fr
        </a>
      </p>

      <div class="faq" id="faq">
        <h2 style="margin:0 0 10px;">FAQ</h2>
        {(offer.faq || []).map((f) => (
          <details>
            <summary>{f.q}</summary>
            <p>{f.a}</p>
          </details>
        ))}
      </div>
    </div>

    <aside class="card">
      <h2>Indicateurs suivis</h2>
      <p>On pilote sur des métriques simples, orientées business.</p>

      <div class="kpis" aria-label="KPIs">
        {(offer.kpis || []).map((k) => (
          <div class="kpi">
            <strong>{k}</strong>
            <span>Suivi & optimisation</span>
          </div>
        ))}
      </div>

      <h2 style="margin-top:16px;">Preuves sans avis</h2>
      <p>Process visible, livrables, tracking et transparence.</p>
      <div class="pills">
        <span class="pill">Process</span>
        <span class="pill">Livrables</span>
        <span class="pill">Tracking</span>
        <span class="pill">Qualif stricte</span>
      </div>

      <h2 style="margin-top:16px;">Zones</h2>
      <div class="pills">
        <span class="pill">Sud Oise (60)</span>
        <span class="pill">Val d’Oise (95)</span>
      </div>
    </aside>
  </section>
</div>