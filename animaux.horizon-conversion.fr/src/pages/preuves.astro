---
// src/pages/preuves.astro
import LayoutSeo from "../layouts/LayoutSEO.astro";
import { getCollection } from "astro:content";

const intentions = await getCollection("intentions");
const pageEntry =
  intentions.find((e) => e.id === "hub_preuves" || e.data?.key === "hub:preuves") ?? null;

const page = pageEntry?.data ?? {};

// SEO
const title = page.metaTitle ?? "Preuves | Horizon Conversion Animaux";
const description = page.metaDescription ?? "Preuves, livrables et éléments concrets : ce qu’on met en place et comment on pilote.";
const h1 = page.pageTitleH1 ?? "Preuves";
const lead = page.pageTitleLead ?? "";

// Blocks
const proofs = page.proofs ?? [];
const proofsBlocks = page.proofsBlocks ?? null; // comme sur tes autres pages
const methode = page.methode ?? null;
const process = page.process ?? null;
const cta = page.cta ?? null;
const faqs = page.faqs ?? null;
---

<LayoutSeo title={title} description={description} h1={h1}>
  <!-- PAGE TITLE -->
  <section class="page-title page-title-parallax parallax scroll-detect dark include-header">
    <img src="/assets/images/page-title.jpg" class="parallax-bg" alt={page.pageTitleALT ?? "Preuves"} />
    <div class="container">
      <div class="page-title-row pt-5 pb-3">
        <div class="page-title-content">
          <h1 style="font-size: 40px; line-height: 1.2; font-weight: 700; text-shadow: 1px 1px 1px rgba(0,0,0,0.5);">
            <Fragment set:html={h1} />
          </h1>
          {lead && (
              <span class="fw-light d-none d-md-block" style="font-size: 16px; opacity: .85; max-width: 720px;">
              {lead}
            </span>
          )}

          {!!proofs?.length && (
              <div class="row mt-4" style="max-width: 820px;">
                {proofs.slice(0, 3).map((p) => (
                    <div class="col-md-4">
                      <div style="background: rgba(0,0,0,.35); padding: 12px 14px; border-radius: 12px;">
                        <strong>{p.title}</strong>
                        <br /><small style="opacity:.85;">{p.subtitle}</small>
                      </div>
                    </div>
                ))}
              </div>
          )}
        </div>

        <nav aria-label="breadcrumb" class="d-none d-lg-block">
          <ol class="breadcrumb" style="--bs-breadcrumb-divider: '&#62;';">
            <li class="breadcrumb-item"><a href="/"><i class="uil uil-home"></i></a></li>
            <li class="breadcrumb-item active" aria-current="page">Preuves</li>
          </ol>
        </nav>
      </div>
    </div>
  </section>

  <section id="content">
    <div class="content-wrap pt-0">

      <!-- PREUVES (cards) -->
      {proofsBlocks && (
          <section class="section m-0" style="background-color:#eef2f5;">
            <div class="container">
              <div class="heading-block text-center border-bottom-0 mb-5 mt-4 mx-auto" style="max-width: 720px">
                <h2 class="text-transform-none font-secondary fw-normal" style="font-size: 36px;">
                  {proofsBlocks.h2 ?? "Preuves"}
                </h2>
                <span>{proofsBlocks.lead ?? ""}</span>
              </div>

              <div class="row g-4">
                {(proofsBlocks.items ?? []).map((card) => (
                    <div class="col-lg-6">
                      <div class="card border-light shadow-sm h-100" style="border-radius:16px;">
                        <div class="card-body">
                          <h3 class="text-transform-none ls-0 fw-semibold mb-0">{card.title}</h3>
                          {!!card.items?.length && (
                              <ul class="iconlist my-3">
                                {card.items.map((li) => (
                                    <li class="d-block"><i class="bi-check-lg me-1"></i> {li}</li>
                                ))}
                              </ul>
                          )}
                        </div>
                      </div>
                    </div>
                ))}
              </div>

              <div class="text-center mt-4">
                <a href="/contact/" class="button button-large button-rounded" data-cta="1">
                  Demander le mini-audit
                </a>
                <a href="/methode/" class="button button-large button-rounded button-border ms-2" data-cta="1">
                  Voir la méthode
                </a>
              </div>
            </div>
          </section>
      )}

      <!-- (optionnel) METHODE teaser -->
      {methode && (
          <div class="container mt-6">
            <div class="heading-block text-center border-bottom-0 mx-auto" style="max-width: 720px">
              <h2 class="text-transform-none font-secondary fw-normal" style="font-size: 36px;">
                {methode.h2 ?? "Méthode"}
              </h2>
              <span>{methode.lead ?? ""}</span>
            </div>

            <div class="row g-4">
              {(methode.items ?? []).slice(0, 2).map((card) => (
                  <div class="col-lg-6">
                    <div class="card border-light shadow-sm h-100" style="border-radius:16px;">
                      <div class="card-body">
                        <h3 class="text-transform-none ls-0 fw-semibold mb-0">{card.title}</h3>
                        {!!card.items?.length && (
                            <ul class="iconlist my-3">
                              {card.items.slice(0, 4).map((li) => (
                                  <li class="d-block"><i class="bi-check-lg me-1"></i> {li}</li>
                              ))}
                            </ul>
                        )}
                      </div>
                    </div>
                  </div>
              ))}
            </div>
          </div>
      )}

      <!-- PROCESS -->
      {process && (
          <div class="container mt-6">
            <div class="heading-block text-center border-bottom-0 mx-auto" style="max-width: 720px">
              <h2 class="text-transform-none font-secondary fw-normal" style="font-size: 36px;">
                {process.h2 ?? "Processus"}
              </h2>
              <span>{process.lead ?? ""}</span>
            </div>

            <ul class="process-steps process-2 feature-box row col-mb-30 justify-content-center mb-4">
              {(process.items ?? []).map((s, idx) => (
                  <li class="col-sm-3">
                    <a href={s.href ?? "#"} class="i-style rounded-circle i-alt mx-auto bg-color">{idx + 1}</a>
                    <h3 class="text-transform-none ls-0 fw-semibold mt-3 mb-0">{s.title}</h3>
                    <p class="mt-3 mb-0">{s.text}</p>
                  </li>
              ))}
            </ul>
          </div>
      )}

      <!-- CTA -->
      {cta && (
          <div class="section dark parallax scroll-detect mb-0" style="padding: 120px 0;">
            <img src="/assets/images/others/section-bg.jpg" class="parallax-bg" alt={cta.alt ?? ""} />
            <div class="container text-center">
              <div class="row justify-content-center">
                <div class="col-lg-8">
                  <div class="heading-block border-bottom-0 mb-0">
                    <div class="before-heading text-lowercase ls-1 text-white fw-normal">{cta.eyebrow ?? ""}</div>
                    <h2 class="text-transform-none font-secondary fw-normal" style="font-size: 30px;">
                      {cta.title ?? "On en parle ?"}
                    </h2>
                    <a href={cta.buttonHref ?? "/contact/"} class="button button-large button-circle button-border button-white button-light mt-4 ms-0" data-cta="1">
                      {cta.buttonLabel ?? "Contact"}
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>
      )}

      <!-- FAQ -->
      {faqs?.items?.length && (
          <div class="container mt-6">
            <div class="heading-block text-center border-bottom-0 mx-auto" style="max-width: 720px">
              <h2 class="text-transform-none font-secondary fw-normal" style="font-size: 36px;">
                {faqs.h2 ?? "FAQs"}
              </h2>
              <span>{faqs.lead ?? ""}</span>
            </div>

            <div class="row justify-content-center">
              <div class="col-lg-10">
                {faqs.items.map((f) => (
                    <div class="toggle">
                      <div class="toggle-header">
                        <div class="toggle-icon">
                          <i class="toggle-closed bi-question-circle"></i>
                          <i class="toggle-open bi-question-circle"></i>
                        </div>
                        <div class="toggle-title">{f.q}</div>
                      </div>
                      <div class="toggle-content">{f.a}</div>
                    </div>
                ))}
              </div>
            </div>
          </div>
      )}

    </div>
  </section>
</LayoutSeo>
